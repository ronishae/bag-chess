<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <title>Bag Chess</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>♟️</text></svg>">
</head>
<body>
    <div id="game-control">
        <span>Game Code:</span>
        <input type="text" id="game-code-input" maxlength="6" />
        <button id="create-game-button">Create Game</button>
        <button id="join-game-button">Join Game</button>
    </div>
    
    <div id="game-container">
        <div id ="black-timer">
            <span id="black-timer-text"></span>
        </div>
        <div id="black-bag">
            <!-- <img id="black-bag-flag" src="pieces/bf.png" class="used-piece bag-image" /> -->
            <img id="black-bag-pawn" src="pieces/bp.png" class="bag-image" draggable="false" />
            <img id="black-bag-rook" src="pieces/br.png" class="bag-image" draggable="false" />
            <img id="black-bag-knight" src="pieces/bn.png" class="bag-image" draggable="false" />
            <img id="black-bag-bishop" src="pieces/bb.png" class="bag-image" draggable="false" />
            <img id="black-bag-queen" src="pieces/bq.png" class="bag-image" draggable="false" />
            <img id="black-bag-king" src="pieces/bk.png" class="bag-image" draggable="false" />
        </div>
        <div id="board"></div>
        <div id="white-bag" class="green-background">
            <!-- <img id="white-bag-flag" src="pieces/f.png" class="used-piece bag-image" /> -->
            <img id="white-bag-pawn" src="pieces/p.png" class="bag-image" draggable="false" />
            <img id="white-bag-rook" src="pieces/r.png" class="bag-image" draggable="false" />
            <img id="white-bag-knight" src="pieces/n.png" class="bag-image" draggable="false" />
            <img id="white-bag-bishop" src="pieces/b.png" class="bag-image" draggable="false" />
            <img id="white-bag-queen" src="pieces/q.png" class="bag-image" draggable="false" />
            <img id="white-bag-king" src="pieces/k.png" class="bag-image" draggable="false" />
        </div>
        <div id="white-timer">
            <span id="white-timer-text"></span>
        </div>
        <div id="game-status-message">
            <span id="message-text">Welcome!</span>
        </div>
    </div>

    <section id="rules">
        <h1>Bag Chess Rules</h1>

        <section class="rule-card">
            <h2>1. Move Bag</h2>
            <p>
                You can only move pieces that are in your "move bag."
                It initially starts with every normal* (see change 2) piece. 
                When that piece moves, it is taken out of the move bag.
            </p>
            <p>
                At the end of your turn, if the move bag is empty, or contains only pieces with no legal
                moves, then the move bag is refilled again. 
            </p>
            <p>
                Move bags are displayed on each player's side of the chess board.
            </p>
        </section>

        <section class="rule-card">
            <h2>2. New Piece: Flag Bearer</h2>
            <p>
                It looks like a pawn with a flag.
                Each player has two, replacing the pawns in front of each rook.
            </p>
            <p>
                It moves like a rook, except it can <b>pass through friendly pieces</b>, and
                it <b>cannot capture or give check/checkmate</b>.
            </p>
    
            <p>
                The flag bearer is <b>exempt from the bag rule</b>, and can be moved regardless of the bag's state.
            </p>
            
            <p>
                <b>The flag bearer will move a passenger with it when it moves.</b>
                The passenger is the friendly piece immediately behind 
                (opposite to the direction of movement) the flag bearer.
            </p>
    
            <p>
                The passenger cannot be a pawn. 
            </p>
    
            <p>
                If the passenger is a king, even if the squares in between are
                attacked, the move is still legal, as long as the king's ending square is not attacked.
            </p>
    
            <p>
                If there is no space for the passenger at the destination, or there is no passenger, 
                the flag bearer will move alone.
            </p>
        </section>

        <section class="rule-card">
            <h2>3. New Win Condition: "Bagmate"</h2>
            <p> This is a special win condition for this variant! 
                <b>You win if it is your opponent's turn and they have no legal moves 
                because none of their surviving pieces have bag move rights.</b>
                This occurs when you capture the last remaining piece 
                type with available moves in their bag (and their flag bearers cannot move
                or are captured). 
            </p>
            <p>
                Stalemate still exists. If the opponent has no legal moves, but at least one of
                their surviving pieces has bag move rights (or is a flag bearer), then the game is a draw.
            </p>
        </section>

        <section class="rule-card">
            <h2>Clarifications</h2>
            <p>
                Even if a piece cannot move because it is not in the move bag, it is still able to give check / checkmate.
            </p>
            <p>
                The flag bearer may bring passengers with it even when travelling through pieces.
            </p>
            <p>
                The passenger's bag state is irrelevant when carried by the flag bearer.
            </p>
            <p>
                Castling is considered a king move only. The rook's bag state is irrelevant.
            </p>
            <p>
                Auto-queen is enabled.
            </p>
        </section>
    </section>
    
</body>

<script type="module" src="script.js"></script>
</html>